<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Multi-Year Gallery Test - A Lo Cubano Boulder Fest</title>
    
    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="/images/favicon.ico">
    <link rel="icon" type="image/svg+xml" href="/images/favicon-circle.svg">
    
    <!-- Stylesheets -->
    <link rel="stylesheet" href="/css/base.css">
    <link rel="stylesheet" href="/css/typography.css">
    <link rel="stylesheet" href="/css/components.css">
    <link rel="stylesheet" href="/css/navigation.css">
    <link rel="stylesheet" href="/css/mobile-overrides.css">
    
    <!-- Meta Tags -->
    <meta name="description" content="Test page for the Multi-Year Gallery Manager component">
    <meta name="robots" content="noindex, nofollow">
    
    <!-- Open Graph -->
    <meta property="og:title" content="Multi-Year Gallery Test">
    <meta property="og:description" content="Testing the Multi-Year Gallery Manager functionality">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://alocubanoboulderfest.com/gallery-multi-year-test">
</head>

<body>
    <!-- Header -->
    <header class="site-header">
        <div class="container">
            <div class="header-content">
                <div class="logo-container">
                    <a href="/home" class="logo-link" aria-label="A Lo Cubano Boulder Fest - Home">
                        <img src="/images/logo.png" alt="A Lo Cubano Boulder Fest Logo" class="logo" width="60" height="60">
                    </a>
                </div>
                
                <nav class="main-nav" role="navigation" aria-label="Main Navigation">
                    <ul class="nav-list">
                        <li><a href="/home" class="nav-link">Home</a></li>
                        <li><a href="/about" class="nav-link">About</a></li>
                        <li><a href="/artists" class="nav-link">Artists</a></li>
                        <li><a href="/schedule" class="nav-link">Schedule</a></li>
                        <li><a href="/gallery" class="nav-link active" aria-current="page">Gallery</a></li>
                        <li><a href="/tickets" class="nav-link">Tickets</a></li>
                        <li><a href="/donations" class="nav-link">Donate</a></li>
                    </ul>
                </nav>
                
                <button class="menu-toggle" aria-label="Open Navigation Menu" aria-expanded="false">
                    <span class="hamburger-line"></span>
                    <span class="hamburger-line"></span>
                    <span class="hamburger-line"></span>
                </button>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="main-content">
        <div class="container">
            <!-- Page Header -->
            <section class="page-header">
                <h1 class="page-title">Multi-Year Gallery Test</h1>
                <p class="page-subtitle">
                    Testing the Multi-Year Gallery Manager component with year switching, 
                    keyboard navigation, URL state management, and statistics display.
                </p>
            </section>
            
            <!-- Gallery Container -->
            <section class="gallery-section">
                <div id="multi-year-gallery-container" class="multi-year-container">
                    <!-- Multi-Year Gallery Manager will initialize here -->
                </div>
            </section>
            
            <!-- Test Controls -->
            <section class="test-controls" style="margin-top: 2rem; padding: 1rem; background: #f5f5f5; border-radius: 8px;">
                <h2>Test Controls</h2>
                <div class="control-group">
                    <button id="get-current-year" class="btn btn-secondary">Get Current Year</button>
                    <button id="get-stats" class="btn btn-secondary">Get Statistics</button>
                    <button id="get-available-years" class="btn btn-secondary">Get Available Years</button>
                    <button id="destroy-gallery" class="btn btn-accent">Destroy Gallery</button>
                    <button id="reinit-gallery" class="btn btn-primary">Reinitialize Gallery</button>
                </div>
                <div id="test-output" style="margin-top: 1rem; padding: 1rem; background: white; border-radius: 4px; font-family: monospace; font-size: 0.9em; max-height: 200px; overflow-y: auto;"></div>
            </section>
            
            <!-- Usage Instructions -->
            <section class="usage-instructions" style="margin-top: 2rem;">
                <h2>Usage Instructions</h2>
                <ul>
                    <li><strong>Year Navigation:</strong> Click on year buttons to switch between different festival years</li>
                    <li><strong>Keyboard Navigation:</strong> Use arrow keys (←→↑↓) to navigate between years when gallery is focused</li>
                    <li><strong>URL State:</strong> Year selection is reflected in the URL and supports browser back/forward</li>
                    <li><strong>Statistics:</strong> View image counts and total sizes for each year</li>
                    <li><strong>Preloading:</strong> Adjacent years are preloaded in the background for smooth transitions</li>
                    <li><strong>Error Handling:</strong> Retry functionality for failed loads</li>
                </ul>
            </section>
        </div>
    </main>

    <!-- Footer -->
    <footer class="site-footer">
        <div class="container">
            <div class="footer-content">
                <p>&copy; 2025 A Lo Cubano Boulder Fest. All rights reserved.</p>
                <p>Multi-Year Gallery Manager Test Page</p>
            </div>
        </div>
    </footer>

    <!-- Scripts -->
    <script src="/js/navigation.js"></script>
    <script src="/js/multi-year-gallery.js"></script>
    <script>
        // Global variables
        let multiYearGallery = null;
        let testOutput = null;
        
        // Initialize when DOM is loaded
        document.addEventListener('DOMContentLoaded', async function() {
            testOutput = document.getElementById('test-output');
            
            // Initialize Multi-Year Gallery
            await initializeMultiYearGallery();
            
            // Set up test controls
            setupTestControls();
            
            log('Multi-Year Gallery Test Page Initialized');
        });
        
        /**
         * Initialize the Multi-Year Gallery Manager
         */
        async function initializeMultiYearGallery() {
            try {
                const container = document.getElementById('multi-year-gallery-container');
                
                if (!container) {
                    throw new Error('Gallery container not found');
                }
                
                // Initialize with test configuration
                multiYearGallery = new MultiYearGalleryManager({
                    container: container,
                    defaultYear: '2025',
                    preloadAdjacentYears: true,
                    enableKeyboardNavigation: true,
                    enableUrlStateManagement: true,
                    showStatistics: true
                });
                
                // Set up event listeners
                container.addEventListener('multiYearGallery:initialized', (event) => {
                    log(`Gallery initialized with year: ${event.detail.year}`);
                });
                
                container.addEventListener('multiYearGallery:yearChanged', (event) => {
                    log(`Year changed from ${event.detail.previousYear} to ${event.detail.currentYear}`);
                });
                
                log('Multi-Year Gallery Manager created and initializing...');
                
            } catch (error) {
                log(`Error initializing gallery: ${error.message}`, 'error');
            }
        }
        
        /**
         * Set up test control buttons
         */
        function setupTestControls() {
            // Get Current Year
            document.getElementById('get-current-year').addEventListener('click', () => {
                if (multiYearGallery) {
                    log(`Current year: ${multiYearGallery.currentYear}`);
                } else {
                    log('Gallery not initialized', 'error');
                }
            });
            
            // Get Statistics
            document.getElementById('get-stats').addEventListener('click', () => {
                if (multiYearGallery && multiYearGallery.currentYear) {
                    const stats = multiYearGallery.getYearStatistics(multiYearGallery.currentYear);
                    log(`Statistics for ${multiYearGallery.currentYear}: ${JSON.stringify(stats, null, 2)}`);
                } else {
                    log('Gallery not initialized or no current year', 'error');
                }
            });
            
            // Get Available Years
            document.getElementById('get-available-years').addEventListener('click', () => {
                if (multiYearGallery) {
                    const years = multiYearGallery.getAvailableYears();
                    log(`Available years: ${JSON.stringify(years)}`);
                } else {
                    log('Gallery not initialized', 'error');
                }
            });
            
            // Destroy Gallery
            document.getElementById('destroy-gallery').addEventListener('click', () => {
                if (multiYearGallery) {
                    multiYearGallery.destroy();
                    multiYearGallery = null;
                    log('Gallery destroyed');
                } else {
                    log('Gallery already destroyed or not initialized', 'error');
                }
            });
            
            // Reinitialize Gallery
            document.getElementById('reinit-gallery').addEventListener('click', async () => {
                if (multiYearGallery) {
                    multiYearGallery.destroy();
                }
                await initializeMultiYearGallery();
                log('Gallery reinitialized');
            });
        }
        
        /**
         * Log messages to the test output
         */
        function log(message, type = 'info') {
            if (!testOutput) return;
            
            const timestamp = new Date().toLocaleTimeString();
            const logEntry = document.createElement('div');
            logEntry.style.marginBottom = '0.5rem';
            logEntry.style.color = type === 'error' ? '#cc2936' : '#333';
            logEntry.innerHTML = `<strong>[${timestamp}]</strong> ${message}`;
            
            testOutput.appendChild(logEntry);
            testOutput.scrollTop = testOutput.scrollHeight;
        }
        
        // Global error handler
        window.addEventListener('error', (event) => {
            log(`Global error: ${event.error.message}`, 'error');
        });
        
        // Global unhandled promise rejection handler
        window.addEventListener('unhandledrejection', (event) => {
            log(`Unhandled promise rejection: ${event.reason}`, 'error');
        });
    </script>
</body>
</html>